<html>
	<head>
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="css/print.css">
	</head>
	<body>
		<h3>Outstanding Charts</h3>
		<ul class="records">
			<li class="header">
				<div class="name">Name</div>
				<div class="location">Location</div>
				<div class="time">Time</div>
				<div class="notes">Notes</div>
			</li>
		</ul>
	</body>
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/database.js"></script>
	<script type="text/javascript" src="js/constants.js"></script>
	<script type="text/javascript">
		var database = new Database(),
			records = $('.records');
		database.getOutstandingCharts(function(charts) {
			console.log(charts);
			var i, c, item, key, name, location, time, notes;
			for(i = 0; i < charts.length; i++) {
				c = charts[i];
				item = $('<li></li>');
				key = c.last + c.first + c.birthday;
				item.attr('data-key', key);

				name = $('<div class="name">' + c.last + ', ' + c.first + ' <small>' + c.birthday + '</small>' + '</div>');
				location = $('<div class="location">' + c.location + '</div>');
				time = $('<div class="time">' + formatDate(c.check_out_time) + '</div>');
				notes = $('<div class="notes">' + c.notes + '</div>');
				item.append(name, location, time, notes);
				records.append(item);

				if(records.find('li').length == 0) {
					records.append(item);
				} else {
					var added = false;
					records.find('li').each(function(i, el) {
						if(!added) {
							var k = $(el).attr('data-key');
							if(key < k) {
								$(el).before(item);
								added = true;
							}	
						}
					});
					if(!added) {
						records.append(item);
					}
				}
			}
			window.print();
			window.close();
		});
	</script>
</html>